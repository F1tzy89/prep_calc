<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Prep Units Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f4f6;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 16px;
    }

    .calculator-wrapper {
      width: 100%;
      max-width: 640px;
    }

    .calculator {
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12);
      border: 1px solid #e5e7eb;
      padding: 18px 16px;
    }

    @media (min-width: 640px) {
      .calculator { padding: 22px 24px; }
    }

    h1 {
      margin: 0 0 4px;
      font-size: 1.4rem;
      font-weight: 600;
      color: #111827;
    }

    .subtitle {
      margin: 0 0 16px;
      font-size: 0.9rem;
      color: #6b7280;
    }

    .section {
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid #e5e7eb;
    }

    .section:first-of-type {
      border-top: none;
      padding-top: 0;
      margin-top: 0;
    }

    .section-title {
      font-weight: 600;
      font-size: 0.9rem;
      color: #374151;
      margin-bottom: 8px;
    }

    .subsection-title {
      font-weight: 600;
      font-size: 0.85rem;
      color: #4b5563;
      margin: 10px 0 4px;
    }

    label {
      display: block;
      font-size: 0.8rem;
      color: #4b5563;
      margin-bottom: 4px;
    }

    .forecast-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: flex-end;
    }

    .forecast-row > div {
      flex: 1 1 180px;
    }

    input[type="number"] {
      width: 100%;
      padding: 7px 9px;
      border-radius: 4px;
      border: 1px solid #d1d5db;
      font-size: 0.9rem;
      outline: none;
    }

    input[type="number"]:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.3);
    }

    .input-prefix {
      display: flex;
      align-items: center;
      border-radius: 4px;
      border: 1px solid #d1d5db;
      overflow: hidden;
      background: #f9fafb;
    }

    .input-prefix span {
      padding: 7px 9px;
      font-size: 0.9rem;
      color: #4b5563;
      border-right: 1px solid #e5e7eb;
      background: #f3f4f6;
    }

    .input-prefix input {
      border: none;
      border-radius: 0;
      background: #ffffff;
    }

    .btn {
      border: none;
      border-radius: 4px;
      padding: 8px 12px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #3b82f6;
      color: #ffffff;
    }

    .btn:hover { background: #2563eb; }

    .small-note {
      font-size: 0.75rem;
      color: #9ca3af;
      margin-top: 4px;
    }

    .error {
      color: #b91c1c;
      font-size: 0.8rem;
      margin-top: 4px;
    }

    .items-table-wrapper { margin-top: 6px; overflow-x: auto; }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }

    th, td {
      padding: 6px 4px;
      border-bottom: 1px solid #e5e7eb;
    }

    th {
      text-align: left;
      font-weight: 500;
      font-size: 0.75rem;
      color: #6b7280;
      text-transform: uppercase;
    }

    .money-cell {
      font-variant-numeric: tabular-nums;
      color: #111827;
    }

    .qty-cell {
      text-align: right;
      font-variant-numeric: tabular-nums;
      font-weight: 600;
      color: #111827;
      min-width: 90px;
    }

    .result-panel {
      margin-top: 18px;
      padding: 10px 12px;
      border-radius: 6px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      font-size: 0.85rem;
      display: none;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .result-panel strong { color: #111827; }
  </style>
</head>
<body>
  <div class="calculator-wrapper">
    <div class="calculator">
      <h1>Prep Calculator</h1>

      <!-- Forecast -->
      <div class="section">
        <div class="section-title">Forecast</div>
        <div class="forecast-row">
          <div>
            <label for="forecastInput">Today's forecast (£)</label>
            <div class="input-prefix">
              <span>£</span>
              <input type="number" id="forecastInput" placeholder="1500" min="0" />
            </div>
            <div id="forecastError" class="error" style="display:none;"></div>
          </div>
          <div style="flex:0 0 auto;">
            <button id="calculateBtn" class="btn" type="button">
              Calculate prep
            </button>
          </div>
        </div>
      </div>

      <!-- Items -->
      <div class="section">
        <div class="section-title">Items</div>
        <div id="sectionsContainer"></div>
      </div>


  <script>
    const ITEMS = [
      // Meat
      { id: "meat",         name: "Meat",          section: "Meat",    unitLabel: "case",    unitValue: 850 },
      { id: "bacon",        name: "Bacon",         section: "Meat",    unitLabel: "packet",  unitValue: 900 },
      { id: "dogs",         name: "Dogs",          section: "Meat",    unitLabel: "packet",  unitValue: 2500 },

      // Produce
      { id: "cheese",       name: "Cheese",        section: "Produce", unitLabel: "case",    unitValue: 5000 },
      { id: "lettuce",      name: "Lettuce",       section: "Produce", unitLabel: "1/3 pan",    unitValue: 1500 },
      { id: "jalapenos",    name: "Jalapenos",     section: "Produce", unitLabel: "1/3 pan", unitValue: 3000 },
      { id: "greenpepper",  name: "Green Pepper",  section: "Produce", unitLabel: "1/3 pan", unitValue: 3000 },
      { id: "tomato",       name: "Tomatoes",      section: "Produce", unitLabel: "1/3 pan",    unitValue: 2500 },
      { id: "pickles",      name: "Pickles",       section: "Produce", unitLabel: "jar",     unitValue: 1800 },
      { id: "mushroom",     name: "Mushroom",      section: "Produce", unitLabel: "bag",     unitValue: 2500 },
      { id: "onions",       name: "Onions",        section: "Produce", unitLabel: "bag",     unitValue: 6000 },

      // Fries
      { id: "potatoes",     name: "Potatoes",      section: "Fries",   unitLabel: "bag",     unitValue: 650 }
    ];

    (function () {
      const forecastInput = document.getElementById("forecastInput");
      const forecastError = document.getElementById("forecastError");
      const calculateBtn = document.getElementById("calculateBtn");
      const summaryPanel = document.getElementById("summaryPanel");
      const summaryForecast = document.getElementById("summaryForecast");
      const sectionsContainer = document.getElementById("sectionsContainer");

      function formatMoney(n) {
        if (isNaN(n)) return "£0.00";
        return "£" + n.toFixed(2);
      }

      function renderSections() {
        const sections = ["Meat", "Produce", "Fries"];

        sections.forEach(sectionName => {
          const sectionItems = ITEMS.filter(item => item.section === sectionName);
          if (sectionItems.length === 0) return;

          const sectionDiv = document.createElement("div");

          const title = document.createElement("div");
          title.className = "subsection-title";
          title.textContent = sectionName;
          sectionDiv.appendChild(title);

          const wrapper = document.createElement("div");
          wrapper.className = "items-table-wrapper";

          const table = document.createElement("table");
          const thead = document.createElement("thead");
          thead.innerHTML = `
            <tr>
              <th>Item</th>
              <th>Prep unit</th>
              <th>Value per unit (£)</th>
              <th style="text-align:right;">Units needed</th>
            </tr>
          `;
          table.appendChild(thead);

          const tbody = document.createElement("tbody");

          sectionItems.forEach(item => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${item.name}</td>
              <td>${item.unitLabel}</td>
              <td class="money-cell">${formatMoney(item.unitValue)}</td>
              <td class="qty-cell" id="qty-${item.id}">–</td>
            `;
            tbody.appendChild(tr);
          });

          table.appendChild(tbody);
          wrapper.appendChild(table);
          sectionDiv.appendChild(wrapper);

          sectionsContainer.appendChild(sectionDiv);
        });
      }

      function calculateUnits() {
        forecastError.style.display = "none";
        forecastError.textContent = "";

        const raw = forecastInput.value.trim();
        const forecast = parseFloat(raw);

        if (isNaN(forecast) || forecast <= 0) {
          forecastError.textContent = "Please enter a positive forecast amount (in £).";
          forecastError.style.display = "block";
          summaryPanel.style.display = "none";
          ITEMS.forEach(item => {
            const cell = document.getElementById("qty-" + item.id);
            if (cell) cell.textContent = "–";
          });
          return;
        }

        ITEMS.forEach(item => {
          const cell = document.getElementById("qty-" + item.id);
          if (!cell) return;

          const unitValue = item.unitValue;
          if (isNaN(unitValue) || unitValue <= 0) {
            cell.textContent = "–";
            return;
          }

          const rawUnits = forecast / unitValue;
          const units = Math.ceil(rawUnits); 

          cell.textContent = `${units} x ${item.unitLabel}`;
        });

        summaryForecast.textContent = formatMoney(forecast);
        summaryPanel.style.display = "flex";
      }

      renderSections();
      calculateBtn.addEventListener("click", calculateUnits);
      forecastInput.addEventListener("change", calculateUnits);
    })();
  </script>
</body>
</html>
